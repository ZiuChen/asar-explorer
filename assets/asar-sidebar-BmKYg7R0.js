import{It as e,Pt as t,T as n,Vt as r,W as i}from"./vendor_@vue_reactivity@3.6.0-alpha.6-DZKOJXGm.js";import{B as a,M as o,O as s,Rt as c,W as l,en as u,gn as d,j as f,k as p,lt as m,mn as h,pn as g,rr as _,s as v,vn as y,z as b}from"./vendor_@vue_runtime-core@3.6.0-alpha.6-BjE3k_Rr.js";import{Y as x}from"./vendor_@vue_runtime-dom@3.6.0-alpha.6-DIxWpe74.js";import"./vendor_@vue_runtime-vapor@3.6.0-alpha.6_@vue_runtime-dom@3.6.0-alpha.6-GqVkSY40.js";import"./vendor_@vueuse_core@12.8.2_typescript@5.9.3-DL4gLfcS.js";import{a as S,d as C,f as w,g as T,h as E,i as D,m as O,o as k,p as A,t as j,u as M}from"./vendor_lucide-vue-next@0.560.0_vue@3.6.0-alpha.6_typescript@5.9.3_-D6c1sQFP.js";import"./vendor_class-variance-authority@0.7.1-CpkMJyQz.js";import{a as N,c as P,i as F,o as I}from"./vendor_reka-ui@2.6.1_typescript@5.9.3_vue@3.6.0-alpha.6_typescript@5.9.3_-Cg17xr5T.js";import"./vendor_tailwind-merge@3.4.0-C3EvnfGD.js";import"./vendor_@vueuse_core@14.1.0_vue@3.6.0-alpha.6_typescript@5.9.3_-CBTGw1FF.js";import"./vendor_idb@8.0.3-CGNuP9rx.js";import"./vendor_crypto-js@4.2.0-aSEXufgj.js";import"./vendor_nanoid@5.1.6-Cg4b_36K.js";import{n as L,r as R,t as z}from"./index-C3AQLoED.js";var B=l({__name:`Collapsible`,props:{defaultOpen:{type:Boolean},open:{type:Boolean},disabled:{type:Boolean},unmountOnHide:{type:Boolean},asChild:{type:Boolean},as:{}},emits:[`update:open`],setup(t,{emit:n}){let r=P(t,n);return(t,n)=>(u(),p(i(I),c({"data-slot":`collapsible`},i(r)),{default:_(n=>[h(t.$slots,`default`,e(m(n)))]),_:3},16))}}),V=l({__name:`CollapsibleContent`,props:{forceMount:{type:Boolean},asChild:{type:Boolean},as:{}},setup(e){let t=e;return(e,n)=>(u(),p(i(N),c({"data-slot":`collapsible-content`},t),{default:_(()=>[h(e.$slots,`default`)]),_:3},16))}}),H=l({__name:`CollapsibleTrigger`,props:{asChild:{type:Boolean},as:{}},setup(e){let t=e;return(e,n)=>(u(),p(i(F),c({"data-slot":`collapsible-trigger`},t),{default:_(()=>[h(e.$slots,`default`)]),_:3},16))}}),U={class:`truncate flex-1`},W={key:1},G={class:`flex items-center gap-2 px-2 py-1.5 text-sm rounded-md cursor-pointer hover:bg-accent transition-colors w-full text-left`},K={class:`truncate`},q={class:`pl-4 border-l border-border/50 ml-2`},J=l({name:`AsarFileTree`,__name:`asar-file-tree`,props:{node:{},selectedPath:{},modifiedFiles:{}},emits:[`select`],setup(e,{emit:n}){let c=e,l=n,m=`.js,.mjs,.cjs,.ts,.mts,.cts,.jsx,.tsx,.json,.html,.htm,.css,.scss,.sass,.less,.vue,.svelte,.md,.txt,.xml,.yaml,.yml,.env,.gitignore,.sh,.bash,.py,.sql`.split(`,`);function h(){c.node.isDirectory||l(`select`,c.node)}function b(e){return e.path===c.selectedPath}function x(e){return e.modified||(c.modifiedFiles?.has(e.path)??!1)}function S(e){return e.isDirectory?M:T(e.name)?A:C}function T(e){let t=e.substring(e.lastIndexOf(`.`)).toLowerCase();return m.includes(t)}return(n,c)=>{let m=d(`AsarFileTree`,!0);return e.node.isDirectory?(u(),o(`div`,W,[a(i(B),{class:`group/collapsible [&[data-state=open]>button>svg:first-child]:rotate-90`},{default:_(()=>[a(i(H),{"as-child":``},{default:_(()=>[s(`button`,G,[a(i(E),{class:`w-4 h-4 transition-transform shrink-0`}),a(i(M),{class:`w-4 h-4 shrink-0`}),s(`span`,K,r(e.node.name),1)])]),_:1}),a(i(V),null,{default:_(()=>[s(`div`,q,[(u(!0),o(v,null,g(e.node.children,t=>(u(),p(m,{key:t.path,node:t,"selected-path":e.selectedPath,"modified-files":e.modifiedFiles,onSelect:c[0]||=e=>l(`select`,e)},null,8,[`node`,`selected-path`,`modified-files`]))),128))])]),_:1})]),_:1})])):(u(),o(`div`,{key:0,class:t([`flex items-center gap-2 px-2 py-1.5 text-sm rounded-md cursor-pointer hover:bg-accent transition-colors`,b(e.node)?`bg-accent text-accent-foreground`:``]),onClick:h},[(u(),p(y(S(e.node)),{class:`w-4 h-4 shrink-0`})),s(`span`,U,r(e.node.name),1),x(e.node)?(u(),p(i(w),{key:0,class:`w-3 h-3 text-yellow-500 shrink-0`})):f(``,!0)],2))}}}),Y={class:`flex flex-col h-full`},X={class:`p-4 border-b`},Z={class:`flex items-center justify-between`},Q={class:`flex items-center gap-2 min-w-0`},$={class:`font-semibold truncate`},ee={class:`flex-1 overflow-auto p-2`},te={class:`mb-2`},ne={class:`space-y-0.5`},re={key:0,class:`mt-4`},ie={class:`px-2 space-y-1`},ae={class:`font-medium`},oe={class:`text-muted-foreground`},se={class:`p-4 border-t space-y-2`},ce={key:0,class:`text-xs text-muted-foreground mb-2`},le={key:1,class:`flex gap-2`},ue=l({__name:`asar-sidebar`,setup(e){let{fileTree:t,currentFile:c,currentAsar:l,modifiedFiles:d,hasModifications:m,isRepacking:h,snapshots:y,openFile:C,resetAllFiles:w,downloadModifiedAsar:E,downloadOriginalAsar:A,createSnapshot:M,closeAsar:N}=z(),P=n(``),F=n(!1);function I(e){e.isDirectory||C(e.path)}async function B(){try{await E()}catch(e){console.error(`Download failed:`,e)}}async function V(){try{await A()}catch(e){console.error(`Download original failed:`,e)}}async function H(){if(confirm(`确定要清除所有修改吗？`))try{await w()}catch(e){console.error(`Reset failed:`,e)}}async function U(){if(P.value.trim())try{await M(P.value.trim()),P.value=``,F.value=!1}catch(e){console.error(`Create snapshot failed:`,e)}}function W(){m.value&&!confirm(`有未保存的修改，确定要关闭吗？`)||N()}return(e,n)=>(u(),o(`div`,Y,[s(`div`,X,[s(`div`,Z,[s(`div`,Q,[a(i(S),{class:`w-5 h-5 shrink-0`}),s(`span`,$,r(i(l)?.name),1)]),a(i(R),{variant:`ghost`,size:`icon`,class:`shrink-0`,onClick:W},{default:_(()=>[a(i(j),{class:`w-4 h-4`})]),_:1})])]),s(`div`,ee,[s(`div`,te,[n[2]||=s(`div`,{class:`text-xs font-medium text-muted-foreground px-2 py-1`},`文件`,-1),s(`div`,ne,[(u(!0),o(v,null,g(i(t),e=>(u(),p(J,{key:e.path,node:e,"selected-path":i(c),"modified-files":i(d),onSelect:I},null,8,[`node`,`selected-path`,`modified-files`]))),128))])]),i(y).length>0?(u(),o(`div`,re,[n[3]||=s(`div`,{class:`text-xs font-medium text-muted-foreground px-2 py-1`},`快照`,-1),s(`div`,ie,[(u(!0),o(v,null,g(i(y),e=>(u(),o(`div`,{key:e.id,class:`text-xs p-2 rounded bg-muted/50`},[s(`p`,ae,r(e.name),1),s(`p`,oe,r(new Date(e.createdAt).toLocaleString()),1)]))),128))])])):f(``,!0)]),s(`div`,se,[i(m)?(u(),o(`div`,ce,` 已修改 `+r(i(d).size)+` 个文件 `,1)):f(``,!0),F.value?(u(),o(`div`,le,[a(i(L),{modelValue:P.value,"onUpdate:modelValue":n[0]||=e=>P.value=e,placeholder:`快照名称`,class:`flex-1`,onKeyup:x(U,[`enter`])},null,8,[`modelValue`]),a(i(R),{size:`icon`,onClick:U,disabled:!P.value.trim()},{default:_(()=>[a(i(T),{class:`w-4 h-4`})]),_:1},8,[`disabled`])])):f(``,!0),i(m)&&!F.value?(u(),p(i(R),{key:2,variant:`outline`,class:`w-full`,onClick:n[1]||=e=>F.value=!0},{default:_(()=>[a(i(T),{class:`w-4 h-4 mr-2`}),n[4]||=b(` 创建快照 `,-1)]),_:1})):f(``,!0),a(i(R),{class:`w-full`,disabled:!i(m)||i(h),onClick:B},{default:_(()=>[i(h)?(u(),p(i(k),{key:0,class:`w-4 h-4 mr-2 animate-spin`})):(u(),p(i(O),{key:1,class:`w-4 h-4 mr-2`})),n[5]||=b(` 下载修改后的 ASAR `,-1)]),_:1},8,[`disabled`]),a(i(R),{variant:`outline`,class:`w-full`,onClick:V},{default:_(()=>[a(i(O),{class:`w-4 h-4 mr-2`}),n[6]||=b(` 下载原始 ASAR `,-1)]),_:1}),i(m)?(u(),p(i(R),{key:3,variant:`destructive`,class:`w-full`,onClick:H},{default:_(()=>[a(i(D),{class:`w-4 h-4 mr-2`}),n[7]||=b(` 清除所有修改 `,-1)]),_:1})):f(``,!0)])]))}});export{ue as default};
//# sourceMappingURL=asar-sidebar-BmKYg7R0.js.map