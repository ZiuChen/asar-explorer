{"version":3,"mappings":"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","names":["dbPromise: Promise<IDBPDatabase<AsarExplorerDB>> | null","results: AsarHistoryItem[]","worker: Worker | null","fileNode: FileNode","result: [string, number][]","modification: FileModification","options: { recursive: boolean }","callback: FileSystemWatchHandle","watcher: FileWatcher","result: string[]","result: {\n        name: string\n        path: string\n        isDirectory: boolean\n        children?: unknown[]\n        size?: number\n        modified?: boolean\n      }[]","item: {\n          name: string\n          path: string\n          isDirectory: boolean\n          children?: unknown[]\n          size?: number\n          modified?: boolean\n        }","workspace: Workspace | null","buffer: ArrayBuffer","fileName: string","source: 'url' | 'data-url'","asarId: string","snapshot: AsarSnapshot","modificationMap: Record<string, Uint8Array>"],"ignoreList":[],"sources":["../../src/utils/shadcn.ts","../../src/components/ui/button/Button.vue","../../src/components/ui/button/index.ts","../../src/components/ui/input/Input.vue","../../src/persist/history.ts","../../src/lib/asar-browser/worker-client.ts","../../src/utils/crypto.ts","../../src/utils/asar-filesystem.ts","../../src/stores/asar.ts","../../src/components/asar-uploader.vue","../../src/components/monaco-editor.vue","../../src/components/ui/resizable/ResizableHandle.vue","../../src/components/ui/resizable/ResizablePanel.vue","../../src/components/ui/resizable/ResizablePanelGroup.vue","../../src/main.ts","../../src/App.vue"],"sourcesContent":["import type { ClassValue } from \"clsx\"\nimport { clsx } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","<script setup lang=\"ts\">\nimport type { PrimitiveProps } from \"reka-ui\"\nimport type { HTMLAttributes } from \"vue\"\nimport type { ButtonVariants } from \".\"\nimport { Primitive } from \"reka-ui\"\nimport { cn } from '@/utils/shadcn'\nimport { buttonVariants } from \".\"\n\ninterface Props extends PrimitiveProps {\n  variant?: ButtonVariants[\"variant\"]\n  size?: ButtonVariants[\"size\"]\n  class?: HTMLAttributes[\"class\"]\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  as: \"button\",\n})\n</script>\n\n<template>\n  <Primitive\n    data-slot=\"button\"\n    :as=\"as\"\n    :as-child=\"asChild\"\n    :class=\"cn(buttonVariants({ variant, size }), props.class)\"\n  >\n    <slot />\n  </Primitive>\n</template>\n","import type { VariantProps } from \"class-variance-authority\"\nimport { cva } from \"class-variance-authority\"\n\nexport { default as Button } from \"./Button.vue\"\n\nexport const buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60\",\n        outline:\n          \"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost:\n          \"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        \"default\": \"h-9 px-4 py-2 has-[>svg]:px-3\",\n        \"sm\": \"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5\",\n        \"lg\": \"h-10 rounded-md px-6 has-[>svg]:px-4\",\n        \"icon\": \"size-9\",\n        \"icon-sm\": \"size-8\",\n        \"icon-lg\": \"size-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  },\n)\nexport type ButtonVariants = VariantProps<typeof buttonVariants>\n","<script setup lang=\"ts\">\nimport type { HTMLAttributes } from \"vue\"\nimport { useVModel } from \"@vueuse/core\"\nimport { cn } from '@/utils/shadcn'\n\nconst props = defineProps<{\n  defaultValue?: string | number\n  modelValue?: string | number\n  class?: HTMLAttributes[\"class\"]\n}>()\n\nconst emits = defineEmits<{\n  (e: \"update:modelValue\", payload: string | number): void\n}>()\n\nconst modelValue = useVModel(props, \"modelValue\", emits, {\n  passive: true,\n  defaultValue: props.defaultValue,\n})\n</script>\n\n<template>\n  <input\n    v-model=\"modelValue\"\n    data-slot=\"input\"\n    :class=\"cn(\n      'file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm',\n      'focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]',\n      'aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive',\n      props.class,\n    )\"\n  >\n</template>\n","/**\n * History Persistence using idb\n * 使用 idb 库操作 IndexedDB 存储 ASAR 历史记录\n */\n\nimport { openDB, type DBSchema, type IDBPDatabase } from 'idb'\nimport type { AsarMeta, AsarSnapshot, FileModification, AsarHistoryItem } from '@/types/asar'\n\nconst DB_NAME = 'asar-explorer'\nconst DB_VERSION = 1\n\n/** 数据库 Schema 定义 */\ninterface AsarExplorerDB extends DBSchema {\n  asars: {\n    key: string\n    value: AsarMeta\n    indexes: {\n      'by-name': string\n      'by-importedAt': number\n      'by-hash': string\n    }\n  }\n  'asar-data': {\n    key: string\n    value: { id: string; data: Uint8Array }\n  }\n  snapshots: {\n    key: string\n    value: AsarSnapshot\n    indexes: {\n      'by-asarId': string\n      'by-createdAt': number\n    }\n  }\n  modifications: {\n    key: string\n    value: FileModification\n    indexes: {\n      'by-asarId': string\n      'by-snapshotId': string\n      'by-path': string\n      'by-asarId-path': [string, string]\n    }\n  }\n}\n\n/** 获取数据库实例 */\nlet dbPromise: Promise<IDBPDatabase<AsarExplorerDB>> | null = null\n\nfunction getDB(): Promise<IDBPDatabase<AsarExplorerDB>> {\n  if (!dbPromise) {\n    dbPromise = openDB<AsarExplorerDB>(DB_NAME, DB_VERSION, {\n      upgrade(db) {\n        // ASAR 元信息存储\n        if (!db.objectStoreNames.contains('asars')) {\n          const asarStore = db.createObjectStore('asars', { keyPath: 'id' })\n          asarStore.createIndex('by-name', 'name')\n          asarStore.createIndex('by-importedAt', 'importedAt')\n          asarStore.createIndex('by-hash', 'hash')\n        }\n\n        // ASAR 原始数据存储\n        if (!db.objectStoreNames.contains('asar-data')) {\n          db.createObjectStore('asar-data', { keyPath: 'id' })\n        }\n\n        // 快照存储\n        if (!db.objectStoreNames.contains('snapshots')) {\n          const snapshotStore = db.createObjectStore('snapshots', { keyPath: 'id' })\n          snapshotStore.createIndex('by-asarId', 'asarId')\n          snapshotStore.createIndex('by-createdAt', 'createdAt')\n        }\n\n        // 文件修改存储\n        if (!db.objectStoreNames.contains('modifications')) {\n          const modStore = db.createObjectStore('modifications', { keyPath: 'id' })\n          modStore.createIndex('by-asarId', 'asarId')\n          modStore.createIndex('by-snapshotId', 'snapshotId')\n          modStore.createIndex('by-path', 'path')\n          modStore.createIndex('by-asarId-path', ['asarId', 'path'])\n        }\n      }\n    })\n  }\n  return dbPromise\n}\n\n// ========== ASAR 操作 ==========\n\n/** 保存 ASAR 元信息和数据 */\nexport async function saveAsar(meta: AsarMeta, data: ArrayBuffer): Promise<void> {\n  const db = await getDB()\n  const tx = db.transaction(['asars', 'asar-data'], 'readwrite')\n  await Promise.all([\n    tx.objectStore('asars').put(meta),\n    tx.objectStore('asar-data').put({ id: meta.id, data: new Uint8Array(data) }),\n    tx.done\n  ])\n}\n\n/** 获取 ASAR 元信息 */\nexport async function getAsarMeta(id: string): Promise<AsarMeta | undefined> {\n  const db = await getDB()\n  return db.get('asars', id)\n}\n\n/** 获取 ASAR 数据 */\nexport async function getAsarData(id: string): Promise<ArrayBuffer | null> {\n  const db = await getDB()\n  const result = await db.get('asar-data', id)\n  return result ? (result.data.buffer as ArrayBuffer) : null\n}\n\n/** 获取所有 ASAR 历史记录 */\nexport async function getAllAsarHistory(): Promise<AsarHistoryItem[]> {\n  const db = await getDB()\n\n  // 获取所有 ASAR 按导入时间倒序\n  const asars = await db.getAllFromIndex('asars', 'by-importedAt')\n  asars.reverse()\n\n  const results: AsarHistoryItem[] = []\n\n  for (const meta of asars) {\n    // 获取快照数量\n    const snapshotCount = await db.countFromIndex('snapshots', 'by-asarId', meta.id)\n\n    // 获取修改文件数量\n    const modifiedFileCount = await db.countFromIndex('modifications', 'by-asarId', meta.id)\n\n    results.push({\n      ...meta,\n      snapshotCount,\n      modifiedFileCount\n    })\n  }\n\n  return results\n}\n\n/** 根据哈希查找已存在的 ASAR */\nexport async function findAsarByHash(hash: string): Promise<AsarMeta | undefined> {\n  const db = await getDB()\n  return db.getFromIndex('asars', 'by-hash', hash)\n}\n\n/** 删除 ASAR 及其所有相关数据 */\nexport async function deleteAsar(id: string): Promise<void> {\n  const db = await getDB()\n  const tx = db.transaction(['asars', 'asar-data', 'snapshots', 'modifications'], 'readwrite')\n\n  // 删除 ASAR 元信息和数据\n  await tx.objectStore('asars').delete(id)\n  await tx.objectStore('asar-data').delete(id)\n\n  // 删除相关快照\n  const snapshotIndex = tx.objectStore('snapshots').index('by-asarId')\n  let snapshotCursor = await snapshotIndex.openCursor(id)\n  while (snapshotCursor) {\n    await snapshotCursor.delete()\n    snapshotCursor = await snapshotCursor.continue()\n  }\n\n  // 删除相关文件修改\n  const modIndex = tx.objectStore('modifications').index('by-asarId')\n  let modCursor = await modIndex.openCursor(id)\n  while (modCursor) {\n    await modCursor.delete()\n    modCursor = await modCursor.continue()\n  }\n\n  await tx.done\n}\n\n// ========== 快照操作 ==========\n\n/** 创建快照 */\nexport async function createSnapshotRecord(snapshot: AsarSnapshot): Promise<void> {\n  const db = await getDB()\n  await db.add('snapshots', snapshot)\n}\n\n/** 获取 ASAR 的所有快照 */\nexport async function getSnapshots(asarId: string): Promise<AsarSnapshot[]> {\n  const db = await getDB()\n  const snapshots = await db.getAllFromIndex('snapshots', 'by-asarId', asarId)\n  return snapshots.sort((a, b) => b.createdAt - a.createdAt)\n}\n\n/** 删除快照 */\nexport async function deleteSnapshotRecord(id: string): Promise<void> {\n  const db = await getDB()\n  const tx = db.transaction(['snapshots', 'modifications'], 'readwrite')\n\n  // 删除快照\n  await tx.objectStore('snapshots').delete(id)\n\n  // 删除关联的文件修改\n  const modIndex = tx.objectStore('modifications').index('by-snapshotId')\n  let cursor = await modIndex.openCursor(id)\n  while (cursor) {\n    await cursor.delete()\n    cursor = await cursor.continue()\n  }\n\n  await tx.done\n}\n\n// ========== 文件修改操作 ==========\n\n/** 保存文件修改 */\nexport async function saveModification(modification: FileModification): Promise<void> {\n  const db = await getDB()\n  const tx = db.transaction('modifications', 'readwrite')\n  const store = tx.objectStore('modifications')\n  const index = store.index('by-asarId-path')\n\n  // 先删除同路径的旧修改\n  let cursor = await index.openCursor([modification.asarId, modification.path])\n  while (cursor) {\n    await cursor.delete()\n    cursor = await cursor.continue()\n  }\n\n  // 添加新修改\n  await store.add(modification)\n  await tx.done\n}\n\n/** 获取文件的最新修改 */\nexport async function getModification(\n  asarId: string,\n  path: string\n): Promise<FileModification | undefined> {\n  const db = await getDB()\n  return db.getFromIndex('modifications', 'by-asarId-path', [asarId, path])\n}\n\n/** 获取 ASAR 的所有修改 */\nexport async function getAllModifications(asarId: string): Promise<FileModification[]> {\n  const db = await getDB()\n  return db.getAllFromIndex('modifications', 'by-asarId', asarId)\n}\n\n/** 删除文件修改 */\nexport async function deleteModification(asarId: string, path: string): Promise<void> {\n  const db = await getDB()\n  const tx = db.transaction('modifications', 'readwrite')\n  const index = tx.objectStore('modifications').index('by-asarId-path')\n\n  let cursor = await index.openCursor([asarId, path])\n  while (cursor) {\n    await cursor.delete()\n    cursor = await cursor.continue()\n  }\n\n  await tx.done\n}\n\n/** 清除 ASAR 的所有修改 */\nexport async function clearModifications(asarId: string): Promise<void> {\n  const db = await getDB()\n  const tx = db.transaction('modifications', 'readwrite')\n  const index = tx.objectStore('modifications').index('by-asarId')\n\n  let cursor = await index.openCursor(asarId)\n  while (cursor) {\n    await cursor.delete()\n    cursor = await cursor.continue()\n  }\n\n  await tx.done\n}\n\n/** 历史记录 API 对象（兼容旧接口） */\nexport const historyDB = {\n  saveAsar,\n  getAsarMeta,\n  getAsarData,\n  getAllAsarHistory,\n  findAsarByHash,\n  deleteAsar,\n  createSnapshot: createSnapshotRecord,\n  getSnapshots,\n  deleteSnapshot: deleteSnapshotRecord,\n  saveModification,\n  getModification,\n  getAllModifications,\n  deleteModification,\n  clearModifications\n}\n","/**\n * ASAR Worker Client - 主线程与 Worker 通信的客户端\n */\n\nimport type { WorkerRequest, WorkerResponse } from './worker'\nimport type { FullFileMetadata } from './types'\n\n// Worker 实例\nlet worker: Worker | null = null\nlet requestId = 0\nconst pendingRequests = new Map<\n  number,\n  {\n    resolve: (value: unknown) => void\n    reject: (reason: unknown) => void\n  }\n>()\n\n/** 获取或创建 Worker */\nfunction getWorker(): Worker {\n  if (!worker) {\n    worker = new Worker(new URL('./worker.ts', import.meta.url), { type: 'module' })\n    worker.onmessage = (event: MessageEvent<WorkerResponse>) => {\n      const response = event.data\n      const pending = pendingRequests.get(response.id)\n      if (pending) {\n        pendingRequests.delete(response.id)\n        if (response.type === 'error') {\n          pending.reject(new Error(response.error))\n        } else {\n          pending.resolve(response.result)\n        }\n      }\n    }\n    worker.onerror = (error) => {\n      console.error('Worker error:', error)\n    }\n  }\n  return worker\n}\n\n/** 发送请求到 Worker */\nfunction sendRequest<T>(\n  type: WorkerRequest['type'],\n  payload: Record<string, unknown>,\n  transfer?: Transferable[]\n): Promise<T> {\n  return new Promise((resolve, reject) => {\n    const id = ++requestId\n    pendingRequests.set(id, { resolve: resolve as (value: unknown) => void, reject })\n    const fullRequest = { type, id, ...payload }\n    if (transfer) {\n      getWorker().postMessage(fullRequest, transfer)\n    } else {\n      getWorker().postMessage(fullRequest)\n    }\n  })\n}\n\n/** 解析 ASAR 头部（在 Worker 中执行） */\nexport async function parseHeaderAsync(data: ArrayBuffer): Promise<{\n  files: FullFileMetadata[]\n  filesOffset: number\n}> {\n  // 复制数据以便传输\n  const copy = data.slice(0)\n  return sendRequest('parseHeader', { data: copy }, [copy])\n}\n\n/** 提取单个文件（在 Worker 中执行） */\nexport async function extractFileAsync(data: ArrayBuffer, path: string): Promise<ArrayBuffer> {\n  return sendRequest('extractFile', { data, path })\n}\n\n/** 批量提取文件（在 Worker 中执行） */\nexport async function extractFilesAsync(\n  data: ArrayBuffer,\n  paths: string[]\n): Promise<Record<string, ArrayBuffer>> {\n  return sendRequest('extractFiles', { data, paths })\n}\n\n/** 修改并重新打包（在 Worker 中执行） */\nexport async function modifyPackageAsync(\n  data: ArrayBuffer,\n  modifications: Record<string, Uint8Array>\n): Promise<Uint8Array> {\n  // 复制数据以便传输\n  const copy = data.slice(0)\n  return sendRequest('modifyPackage', { data: copy, modifications }, [copy])\n}\n\n/** 终止 Worker */\nexport function terminateWorker(): void {\n  if (worker) {\n    worker.terminate()\n    worker = null\n    pendingRequests.clear()\n  }\n}\n","import { SHA256 } from 'crypto-js'\nimport { nanoid } from 'nanoid'\n\nexport function prefixedNanoid(prefix: string = '', size: number = 21): string {\n  return `${prefix}_${nanoid(size)}`\n}\n\nexport async function sha256(data: ArrayBuffer): Promise<string> {\n  if (typeof crypto !== 'undefined' && 'subtle' in crypto) {\n    const hashBuffer = await crypto.subtle.digest('SHA-256', data)\n    const hashArray = Array.from(new Uint8Array(hashBuffer))\n    return hashArray.map((b) => b.toString(16).padStart(2, '0')).join('')\n  }\n\n  // @ts-expect-error - Fallback to crypto-js\n  const wordArray = SHA256(new Uint8Array(data))\n  return wordArray.toString()\n}\n","/**\n * ASAR FileSystem for modern-monaco Workspace\n * 实现 FileSystem 接口，将 ASAR 内容作为虚拟文件系统提供给 Monaco\n */\n\nimport type { FileSystem } from 'modern-monaco'\nimport type { FileModification } from '@/types/asar'\nimport { historyDB } from '@/persist/history'\nimport { parseHeaderAsync, extractFileAsync } from '@/lib/asar-browser'\nimport { prefixedNanoid } from './crypto'\n\n/** 文件系统条目类型 */\nconst FileType = {\n  Unknown: 0,\n  File: 1,\n  Directory: 2,\n  SymbolicLink: 64\n} as const\n\ntype FileSystemEntryType = 0 | 1 | 2 | 64\n\ninterface FileStat {\n  readonly type: FileSystemEntryType\n  readonly ctime: number\n  readonly mtime: number\n  readonly version: number\n  readonly size: number\n}\n\ninterface FileSystemWatchContext {\n  isModelContentChange?: boolean\n}\n\ninterface FileSystemWatchHandle {\n  (\n    kind: 'create' | 'modify' | 'remove',\n    filename: string,\n    type?: number,\n    context?: FileSystemWatchContext\n  ): void\n}\n\n/** 内存中的文件节点 */\ninterface FileNode {\n  type: 1 | 2 // 1=file, 2=directory\n  content?: Uint8Array\n  children?: Map<string, FileNode>\n  size: number\n  ctime: number\n  mtime: number\n  version: number\n  /** 是否从原始 ASAR 加载 */\n  fromAsar: boolean\n  /** 原始 ASAR 中的偏移（用于懒加载） */\n  asarOffset?: number\n}\n\n/** 文件监听器 */\ninterface FileWatcher {\n  path: string\n  recursive: boolean\n  handle: FileSystemWatchHandle\n}\n\n/**\n * ASAR 文件系统\n * 将 ASAR 内容映射为虚拟文件系统供 Monaco 使用\n */\nexport class AsarFileSystem implements FileSystem {\n  private root: FileNode\n  private watchers: FileWatcher[] = []\n  private asarData: ArrayBuffer | null = null\n  private asarId: string | null = null\n\n  constructor() {\n    this.root = this.createDirectoryNode()\n  }\n\n  /** 创建目录节点 */\n  private createDirectoryNode(): FileNode {\n    const now = Date.now()\n    return {\n      type: FileType.Directory as 2,\n      children: new Map(),\n      size: 0,\n      ctime: now,\n      mtime: now,\n      version: 1,\n      fromAsar: false\n    }\n  }\n\n  /** 创建文件节点 */\n  private createFileNode(content: Uint8Array, fromAsar = false): FileNode {\n    const now = Date.now()\n    return {\n      type: FileType.File as 1,\n      content,\n      size: content.length,\n      ctime: now,\n      mtime: now,\n      version: 1,\n      fromAsar\n    }\n  }\n\n  /** 规范化路径 */\n  private normalizePath(path: string): string {\n    // 移除 file:// 协议前缀\n    let normalizedPath = path.replace(/^file:\\/\\//, '')\n    // 移除开头的 / 并规范化\n    return normalizedPath.replace(/^\\/+/, '').replace(/\\/+$/, '').replace(/\\/+/g, '/')\n  }\n\n  /** 获取路径的各个部分 */\n  private getPathParts(path: string): string[] {\n    const normalized = this.normalizePath(path)\n    return normalized ? normalized.split('/') : []\n  }\n\n  /** 获取父目录路径 */\n  private getParentPath(path: string): string {\n    const parts = this.getPathParts(path)\n    parts.pop()\n    return parts.join('/')\n  }\n\n  /** 获取文件名 */\n  private getFileName(path: string): string {\n    const parts = this.getPathParts(path)\n    return parts[parts.length - 1] || ''\n  }\n\n  /** 获取节点 */\n  private getNode(path: string): FileNode | null {\n    const parts = this.getPathParts(path)\n    let node = this.root\n\n    for (const part of parts) {\n      if (node.type !== FileType.Directory || !node.children) {\n        return null\n      }\n      const child = node.children.get(part)\n      if (!child) {\n        return null\n      }\n      node = child\n    }\n\n    return node\n  }\n\n  /** 获取或创建父目录 */\n  private getOrCreateParent(path: string): FileNode {\n    const parentPath = this.getParentPath(path)\n    const parts = this.getPathParts(parentPath)\n    let node = this.root\n\n    for (const part of parts) {\n      if (!node.children) {\n        node.children = new Map()\n      }\n      let child = node.children.get(part)\n      if (!child) {\n        child = this.createDirectoryNode()\n        node.children.set(part, child)\n      }\n      node = child\n    }\n\n    return node\n  }\n\n  /** 通知文件变化 */\n  private notifyWatchers(\n    kind: 'create' | 'modify' | 'remove',\n    filename: string,\n    type: number = FileType.File,\n    context?: FileSystemWatchContext\n  ): void {\n    const normalizedPath = this.normalizePath(filename)\n\n    for (const watcher of this.watchers) {\n      const watchPath = this.normalizePath(watcher.path)\n\n      // 检查是否匹配\n      if (watcher.recursive) {\n        if (\n          normalizedPath.startsWith(watchPath) ||\n          watchPath === '' ||\n          normalizedPath === watchPath\n        ) {\n          watcher.handle(kind, filename, type, context)\n        }\n      } else {\n        const parentPath = this.getParentPath(normalizedPath)\n        if (parentPath === watchPath || (watchPath === '' && !normalizedPath.includes('/'))) {\n          watcher.handle(kind, filename, type, context)\n        }\n      }\n    }\n  }\n\n  // ========== 加载 ASAR ==========\n\n  /** 从 ASAR 数据初始化文件系统（使用 WebWorker 解析头部） */\n  async loadFromAsar(data: ArrayBuffer, asarId: string): Promise<void> {\n    this.asarData = data\n    this.asarId = asarId\n    this.root = this.createDirectoryNode()\n\n    // 在 WebWorker 中解析 ASAR 头部\n    const { files } = await parseHeaderAsync(data)\n\n    // 构建文件树\n    for (const file of files) {\n      const path = file.path.replace(/^\\//, '')\n      const parts = path.split('/').filter(Boolean)\n\n      // 确保父目录存在\n      let node = this.root\n      for (let i = 0; i < parts.length - 1; i++) {\n        const part = parts[i]!\n        if (!node.children) {\n          node.children = new Map()\n        }\n        let child = node.children.get(part)\n        if (!child) {\n          child = this.createDirectoryNode()\n          child.fromAsar = true\n          node.children.set(part, child)\n        }\n        node = child\n      }\n\n      // 创建文件节点（懒加载，不立即读取内容）\n      const fileName = parts[parts.length - 1]\n      if (fileName && node.children) {\n        const fileNode: FileNode = {\n          type: FileType.File as 1,\n          size: file.size || 0,\n          ctime: Date.now(),\n          mtime: Date.now(),\n          version: 1,\n          fromAsar: true,\n          asarOffset: file.fileOffset\n        }\n        node.children.set(fileName, fileNode)\n      }\n    }\n\n    // 加载已有的修改\n    const modifications = await historyDB.getAllModifications(asarId)\n    for (const mod of modifications) {\n      const path = mod.path.replace(/^\\//, '')\n      await this.writeFile(path, mod.content, { isModelContentChange: false })\n    }\n  }\n\n  /** 清空文件系统 */\n  clear(): void {\n    this.root = this.createDirectoryNode()\n    this.asarData = null\n    this.asarId = null\n  }\n\n  /** 获取当前 ASAR ID */\n  getAsarId(): string | null {\n    return this.asarId\n  }\n\n  // ========== FileSystem 接口实现 ==========\n\n  async copy(source: string, target: string, options?: { overwrite: boolean }): Promise<void> {\n    const sourceNode = this.getNode(source)\n    if (!sourceNode) {\n      throw new Error(`Source not found: ${source}`)\n    }\n\n    const targetNode = this.getNode(target)\n    if (targetNode && !options?.overwrite) {\n      throw new Error(`Target already exists: ${target}`)\n    }\n\n    // 读取源文件内容\n    const content = await this.readFile(source)\n    await this.writeFile(target, content)\n  }\n\n  async createDirectory(dir: string): Promise<void> {\n    const parts = this.getPathParts(dir)\n    let node = this.root\n\n    for (const part of parts) {\n      if (!node.children) {\n        node.children = new Map()\n      }\n      let child = node.children.get(part)\n      if (!child) {\n        child = this.createDirectoryNode()\n        node.children.set(part, child)\n        this.notifyWatchers('create', dir, FileType.Directory)\n      }\n      node = child\n    }\n  }\n\n  async delete(filename: string, options?: { recursive: boolean }): Promise<void> {\n    const parentPath = this.getParentPath(filename)\n    const name = this.getFileName(filename)\n    const parent = this.getNode(parentPath)\n\n    if (!parent || !parent.children) {\n      throw new Error(`Not found: ${filename}`)\n    }\n\n    const node = parent.children.get(name)\n    if (!node) {\n      throw new Error(`Not found: ${filename}`)\n    }\n\n    if (node.type === FileType.Directory && node.children?.size && !options?.recursive) {\n      throw new Error(`Directory not empty: ${filename}`)\n    }\n\n    parent.children.delete(name)\n    this.notifyWatchers('remove', filename, node.type)\n  }\n\n  async readDirectory(filename: string): Promise<[string, number][]> {\n    const node = this.getNode(filename)\n    if (!node) {\n      throw new Error(`Not found: ${filename}`)\n    }\n\n    if (node.type !== FileType.Directory || !node.children) {\n      throw new Error(`Not a directory: ${filename}`)\n    }\n\n    const result: [string, number][] = []\n    for (const [name, child] of node.children) {\n      result.push([name, child.type])\n    }\n\n    return result.sort((a, b) => {\n      // 目录优先\n      if (a[1] !== b[1]) {\n        return a[1] === FileType.Directory ? -1 : 1\n      }\n      return a[0].localeCompare(b[0])\n    })\n  }\n\n  async readFile(filename: string): Promise<Uint8Array> {\n    const node = this.getNode(filename)\n    if (!node) {\n      throw new Error(`Not found: ${filename}`)\n    }\n\n    if (node.type !== FileType.File) {\n      throw new Error(`Not a file: ${filename}`)\n    }\n\n    // 如果内容已加载，直接返回\n    if (node.content) {\n      return node.content\n    }\n\n    // 懒加载：在 WebWorker 中从 ASAR 读取\n    if (node.fromAsar && this.asarData) {\n      const content = await extractFileAsync(this.asarData, '/' + this.normalizePath(filename))\n      node.content = new Uint8Array(content)\n      return node.content\n    }\n\n    throw new Error(`Content not available: ${filename}`)\n  }\n\n  async readTextFile(filename: string): Promise<string> {\n    const content = await this.readFile(filename)\n    return new TextDecoder('utf-8').decode(content)\n  }\n\n  async rename(oldName: string, newName: string, options?: { overwrite: boolean }): Promise<void> {\n    await this.copy(oldName, newName, options)\n    await this.delete(oldName, { recursive: true })\n  }\n\n  async stat(filename: string): Promise<FileStat> {\n    const node = this.getNode(filename)\n    if (!node) {\n      throw new Error(`Not found: ${filename}`)\n    }\n\n    return {\n      type: node.type as 0 | 1 | 2 | 64,\n      ctime: node.ctime,\n      mtime: node.mtime,\n      version: node.version,\n      size: node.size\n    }\n  }\n\n  async writeFile(\n    filename: string,\n    content: string | Uint8Array,\n    context?: FileSystemWatchContext\n  ): Promise<void> {\n    const data = typeof content === 'string' ? new TextEncoder().encode(content) : content\n\n    const parent = this.getOrCreateParent(filename)\n    const name = this.getFileName(filename)\n\n    if (!parent.children) {\n      parent.children = new Map()\n    }\n\n    const existingNode = parent.children.get(name)\n    const isCreate = !existingNode\n    const now = Date.now()\n\n    const fileNode: FileNode =\n      existingNode && existingNode.type === FileType.File\n        ? {\n            ...existingNode,\n            content: data,\n            size: data.length,\n            mtime: now,\n            version: existingNode.version + 1,\n            fromAsar: false\n          }\n        : this.createFileNode(data, false)\n\n    parent.children.set(name, fileNode)\n\n    // 保存到 IndexedDB（如果有关联的 ASAR）\n    if (this.asarId && context?.isModelContentChange !== false) {\n      const modification: FileModification = {\n        id: prefixedNanoid('M'),\n        asarId: this.asarId,\n        path: '/' + this.normalizePath(filename),\n        content: data,\n        modifiedAt: now\n      }\n      await historyDB.saveModification(modification)\n    }\n\n    this.notifyWatchers(isCreate ? 'create' : 'modify', filename, FileType.File, context)\n  }\n\n  watch(\n    filename: string,\n    optionsOrHandle: { recursive: boolean } | FileSystemWatchHandle,\n    handle?: FileSystemWatchHandle\n  ): () => void {\n    let options: { recursive: boolean }\n    let callback: FileSystemWatchHandle\n\n    if (typeof optionsOrHandle === 'function') {\n      options = { recursive: false }\n      callback = optionsOrHandle\n    } else {\n      options = optionsOrHandle\n      callback = handle!\n    }\n\n    const watcher: FileWatcher = {\n      path: this.normalizePath(filename),\n      recursive: options.recursive,\n      handle: callback\n    }\n\n    this.watchers.push(watcher)\n\n    // 返回取消监听的函数\n    return () => {\n      const index = this.watchers.indexOf(watcher)\n      if (index !== -1) {\n        this.watchers.splice(index, 1)\n      }\n    }\n  }\n\n  // ========== 扩展方法 ==========\n\n  /** 检查文件是否已修改 */\n  isModified(filename: string): boolean {\n    const node = this.getNode(filename)\n    return node ? !node.fromAsar : false\n  }\n\n  /** 获取所有已修改的文件路径 */\n  getModifiedFiles(): string[] {\n    const result: string[] = []\n\n    const traverse = (node: FileNode, path: string) => {\n      if (node.type === FileType.File && !node.fromAsar) {\n        result.push(path)\n      }\n      if (node.children) {\n        for (const [name, child] of node.children) {\n          traverse(child, path ? `${path}/${name}` : name)\n        }\n      }\n    }\n\n    traverse(this.root, '')\n    return result\n  }\n\n  /** 重置文件到原始状态 */\n  async resetFile(filename: string): Promise<void> {\n    if (!this.asarData || !this.asarId) {\n      throw new Error('No ASAR loaded')\n    }\n\n    const node = this.getNode(filename)\n    if (!node || node.type !== FileType.File) {\n      throw new Error(`Not a file: ${filename}`)\n    }\n\n    // 在 WebWorker 中从 ASAR 重新读取\n    const content = await extractFileAsync(this.asarData, '/' + this.normalizePath(filename))\n    node.content = new Uint8Array(content)\n    node.fromAsar = true\n    node.mtime = Date.now()\n    node.version++\n\n    // 从 IndexedDB 删除修改记录\n    await historyDB.deleteModification(this.asarId, '/' + this.normalizePath(filename))\n\n    this.notifyWatchers('modify', filename, FileType.File)\n  }\n\n  /** 获取文件树结构 */\n  getFileTree(): {\n    name: string\n    path: string\n    isDirectory: boolean\n    children?: unknown[]\n    size?: number\n    modified?: boolean\n  }[] {\n    const buildTree = (\n      node: FileNode,\n      path: string\n    ): {\n      name: string\n      path: string\n      isDirectory: boolean\n      children?: unknown[]\n      size?: number\n      modified?: boolean\n    }[] => {\n      if (!node.children) return []\n\n      const result: {\n        name: string\n        path: string\n        isDirectory: boolean\n        children?: unknown[]\n        size?: number\n        modified?: boolean\n      }[] = []\n\n      for (const [name, child] of node.children) {\n        const fullPath = path ? `${path}/${name}` : name\n        const item: {\n          name: string\n          path: string\n          isDirectory: boolean\n          children?: unknown[]\n          size?: number\n          modified?: boolean\n        } = {\n          name,\n          path: '/' + fullPath,\n          isDirectory: child.type === FileType.Directory\n        }\n\n        if (child.type === FileType.Directory) {\n          item.children = buildTree(child, fullPath)\n        } else {\n          item.size = child.size\n          item.modified = !child.fromAsar\n        }\n\n        result.push(item)\n      }\n\n      return result.sort((a, b) => {\n        if (a.isDirectory !== b.isDirectory) {\n          return a.isDirectory ? -1 : 1\n        }\n        return a.name.localeCompare(b.name)\n      })\n    }\n\n    return buildTree(this.root, '')\n  }\n}\n","/**\n * ASAR Explorer Store\n * 使用 VueUse createGlobalState 管理全局状态\n */\n\nimport { ref, shallowRef, computed, markRaw } from 'vue'\nimport { createGlobalState } from '@vueuse/core'\nimport type { Workspace } from 'modern-monaco'\nimport type { AsarMeta, AsarSnapshot, AsarHistoryItem, FileTreeNode } from '@/types/asar'\nimport { AsarFileSystem } from '@/utils/asar-filesystem'\nimport { modifyPackageAsync } from '@/lib/asar-browser'\nimport { historyDB } from '@/persist/history'\nimport { prefixedNanoid, sha256 } from '@/utils/crypto'\n\n/** 使用 createGlobalState 创建全局状态 */\nexport const useAsarStore = createGlobalState(() => {\n  // ========== 单例实例 ==========\n\n  /** ASAR 文件系统实例 */\n  const asarFS = new AsarFileSystem()\n\n  /** Monaco Workspace 实例 */\n  let workspace: Workspace | null = null\n\n  // ========== 响应式状态 ==========\n\n  /** 当前加载的 ASAR 元信息 */\n  const currentAsar = ref<AsarMeta | null>(null)\n\n  /** 文件树 */\n  const fileTree = shallowRef<FileTreeNode[]>([])\n\n  /** 当前打开的文件路径 */\n  const currentFile = ref<string | null>(null)\n\n  /** 是否正在加载 ASAR */\n  const isLoadingAsar = ref(false)\n\n  /** 是否正在保存 */\n  const isSaving = ref(false)\n\n  /** 是否正在重新打包 */\n  const isRepacking = ref(false)\n\n  /** 错误信息 */\n  const error = ref<string | null>(null)\n\n  /** 修改的文件集合 */\n  const modifiedFiles = ref<Set<string>>(new Set())\n\n  /** ASAR 历史记录列表 */\n  const asarHistory = shallowRef<AsarHistoryItem[]>([])\n\n  /** 当前 ASAR 的快照列表 */\n  const snapshots = shallowRef<AsarSnapshot[]>([])\n\n  /** 编辑器是否就绪 */\n  const isEditorReady = ref(false)\n\n  // ========== 计算属性 ==========\n\n  /** 是否有修改 */\n  const hasModifications = computed(() => modifiedFiles.value.size > 0)\n\n  /** 是否已加载 ASAR */\n  const asarLoaded = computed(() => currentAsar.value !== null)\n\n  // ========== 编辑器管理（由 monaco-editor.vue 组件调用） ==========\n\n  /**\n   * 设置 Workspace 实例（由组件调用）\n   */\n  function setWorkspace(ws: Workspace | null): void {\n    workspace = ws ? markRaw(ws) : null\n  }\n\n  /**\n   * 设置编辑器就绪状态（由组件调用）\n   */\n  function setEditorReady(ready: boolean): void {\n    isEditorReady.value = ready\n  }\n\n  /**\n   * 加载历史记录\n   */\n  async function loadHistory(): Promise<void> {\n    try {\n      asarHistory.value = await historyDB.getAllAsarHistory()\n    } catch (e) {\n      console.error('Failed to load history:', e)\n    }\n  }\n\n  // ========== ASAR 操作 ==========\n\n  /**\n   * 从文件加载 ASAR\n   */\n  async function loadFromFile(file: File): Promise<void> {\n    try {\n      isLoadingAsar.value = true\n      error.value = null\n\n      const buffer = await file.arrayBuffer()\n      await loadAsarData(buffer, file.name, 'file')\n    } catch (e) {\n      error.value = e instanceof Error ? e.message : String(e)\n      throw e\n    } finally {\n      isLoadingAsar.value = false\n    }\n  }\n\n  /**\n   * 从 URL 加载 ASAR\n   */\n  async function loadFromUrl(url: string): Promise<void> {\n    try {\n      isLoadingAsar.value = true\n      error.value = null\n\n      let buffer: ArrayBuffer\n      let fileName: string\n      let source: 'url' | 'data-url'\n\n      if (url.startsWith('data:')) {\n        // 处理 Data URL\n        fileName = 'data-url.asar'\n        source = 'data-url'\n        const base64 = url.split(',')[1] || ''\n        const binary = atob(base64)\n        const bytes = new Uint8Array(binary.length)\n        for (let i = 0; i < binary.length; i++) {\n          bytes[i] = binary.charCodeAt(i)\n        }\n        buffer = bytes.buffer\n      } else {\n        // 从 URL 获取\n        const urlObj = new URL(url)\n        fileName = urlObj.pathname.split('/').pop() || 'remote.asar'\n        source = 'url'\n\n        const response = await fetch(url)\n        if (!response.ok) {\n          throw new Error(`Failed to fetch: ${response.status} ${response.statusText}`)\n        }\n        buffer = await response.arrayBuffer()\n      }\n\n      await loadAsarData(buffer, fileName, source, url)\n    } catch (e) {\n      error.value = e instanceof Error ? e.message : String(e)\n      throw e\n    } finally {\n      isLoadingAsar.value = false\n    }\n  }\n\n  /**\n   * 从历史记录加载 ASAR\n   */\n  async function loadFromHistory(id: string): Promise<void> {\n    try {\n      isLoadingAsar.value = true\n      error.value = null\n\n      const meta = await historyDB.getAsarMeta(id)\n      if (!meta) {\n        throw new Error('ASAR not found in history')\n      }\n\n      const data = await historyDB.getAsarData(id)\n      if (!data) {\n        throw new Error('ASAR data not found')\n      }\n\n      // 加载到文件系统\n      await asarFS.loadFromAsar(data, id)\n\n      // 更新状态\n      currentAsar.value = meta\n      fileTree.value = asarFS.getFileTree() as FileTreeNode[]\n      modifiedFiles.value = new Set(asarFS.getModifiedFiles())\n      currentFile.value = null\n\n      // 加载快照\n      await loadSnapshots()\n\n      // 更新历史记录（更新最后修改时间）\n      meta.lastModifiedAt = Date.now()\n      await historyDB.saveAsar(meta, data)\n      await loadHistory()\n    } catch (e) {\n      error.value = e instanceof Error ? e.message : String(e)\n      throw e\n    } finally {\n      isLoadingAsar.value = false\n    }\n  }\n\n  /**\n   * 加载 ASAR 数据的内部方法\n   */\n  async function loadAsarData(\n    data: ArrayBuffer,\n    fileName: string,\n    source: 'file' | 'url' | 'data-url',\n    sourceUrl?: string\n  ): Promise<void> {\n    // 计算哈希\n    const hash = await sha256(data)\n\n    // 检查是否已存在\n    let existingMeta = await historyDB.findAsarByHash(hash)\n    let asarId: string\n\n    if (existingMeta) {\n      // 使用已存在的记录\n      asarId = existingMeta.id\n      existingMeta.lastModifiedAt = Date.now()\n      await historyDB.saveAsar(existingMeta, data)\n    } else {\n      // 创建新记录\n      asarId = prefixedNanoid('R')\n      existingMeta = {\n        id: asarId,\n        name: fileName,\n        size: data.byteLength,\n        importedAt: Date.now(),\n        lastModifiedAt: Date.now(),\n        source,\n        sourceUrl,\n        hash\n      }\n      await historyDB.saveAsar(existingMeta, data)\n    }\n\n    // 加载到文件系统\n    await asarFS.loadFromAsar(data, asarId)\n\n    // 更新状态\n    currentAsar.value = existingMeta\n    fileTree.value = asarFS.getFileTree() as FileTreeNode[]\n    modifiedFiles.value = new Set(asarFS.getModifiedFiles())\n    currentFile.value = null\n\n    // 加载快照\n    await loadSnapshots()\n\n    // 刷新历史记录\n    await loadHistory()\n  }\n\n  /**\n   * 关闭当前 ASAR\n   */\n  function closeAsar(): void {\n    asarFS.clear()\n    currentAsar.value = null\n    fileTree.value = []\n    modifiedFiles.value = new Set()\n    currentFile.value = null\n    snapshots.value = []\n  }\n\n  // ========== 文件操作 ==========\n\n  /**\n   * 打开文件\n   */\n  async function openFile(path: string): Promise<void> {\n    if (!workspace) {\n      throw new Error('Editor not initialized')\n    }\n\n    try {\n      // 规范化路径\n      const normalizedPath = path.replace(/^\\/+/, '')\n\n      // 在 Monaco 中打开文件\n      await workspace.openTextDocument(normalizedPath)\n      currentFile.value = path\n    } catch (e) {\n      error.value = e instanceof Error ? e.message : String(e)\n      throw e\n    }\n  }\n\n  /**\n   * 保存当前文件\n   */\n  async function saveCurrentFile(): Promise<void> {\n    // 更新修改文件列表\n    modifiedFiles.value = new Set(asarFS.getModifiedFiles())\n    // 更新文件树（刷新修改状态）\n    fileTree.value = asarFS.getFileTree() as FileTreeNode[]\n  }\n\n  /**\n   * 重置文件到原始状态\n   */\n  async function resetFile(path: string): Promise<void> {\n    try {\n      await asarFS.resetFile(path.replace(/^\\/+/, ''))\n      modifiedFiles.value = new Set(asarFS.getModifiedFiles())\n      fileTree.value = asarFS.getFileTree() as FileTreeNode[]\n\n      // 如果是当前打开的文件，重新打开以刷新内容\n      if (currentFile.value === path) {\n        await openFile(path)\n      }\n    } catch (e) {\n      error.value = e instanceof Error ? e.message : String(e)\n      throw e\n    }\n  }\n\n  /**\n   * 重置所有文件\n   */\n  async function resetAllFiles(): Promise<void> {\n    if (!currentAsar.value) return\n\n    try {\n      // 清除所有修改\n      await historyDB.clearModifications(currentAsar.value.id)\n\n      // 重新加载 ASAR\n      const data = await historyDB.getAsarData(currentAsar.value.id)\n      if (data) {\n        await asarFS.loadFromAsar(data, currentAsar.value.id)\n        fileTree.value = asarFS.getFileTree() as FileTreeNode[]\n        modifiedFiles.value = new Set()\n\n        // 重新打开当前文件\n        if (currentFile.value) {\n          await openFile(currentFile.value)\n        }\n      }\n    } catch (e) {\n      error.value = e instanceof Error ? e.message : String(e)\n      throw e\n    }\n  }\n\n  // ========== 快照操作 ==========\n\n  /**\n   * 加载当前 ASAR 的快照\n   */\n  async function loadSnapshots(): Promise<void> {\n    if (!currentAsar.value) {\n      snapshots.value = []\n      return\n    }\n\n    try {\n      snapshots.value = await historyDB.getSnapshots(currentAsar.value.id)\n    } catch (e) {\n      console.error('Failed to load snapshots:', e)\n      snapshots.value = []\n    }\n  }\n\n  /**\n   * 创建快照\n   */\n  async function createSnapshot(name: string, description?: string): Promise<void> {\n    if (!currentAsar.value) {\n      throw new Error('No ASAR loaded')\n    }\n\n    const snapshot: AsarSnapshot = {\n      id: prefixedNanoid('S'),\n      asarId: currentAsar.value.id,\n      name,\n      createdAt: Date.now(),\n      modifiedFiles: Array.from(modifiedFiles.value),\n      description\n    }\n\n    await historyDB.createSnapshot(snapshot)\n    await loadSnapshots()\n  }\n\n  /**\n   * 删除快照\n   */\n  async function deleteSnapshot(id: string): Promise<void> {\n    await historyDB.deleteSnapshot(id)\n    await loadSnapshots()\n  }\n\n  // ========== 导出操作 ==========\n\n  /**\n   * 下载修改后的 ASAR\n   */\n  async function downloadModifiedAsar(): Promise<void> {\n    if (!currentAsar.value) {\n      throw new Error('No ASAR loaded')\n    }\n\n    try {\n      isRepacking.value = true\n      error.value = null\n\n      // 获取原始数据\n      const originalData = await historyDB.getAsarData(currentAsar.value.id)\n      if (!originalData) {\n        throw new Error('Original ASAR data not found')\n      }\n\n      // 收集所有修改\n      const modifications = await historyDB.getAllModifications(currentAsar.value.id)\n      const modificationMap: Record<string, Uint8Array> = {}\n\n      for (const mod of modifications) {\n        modificationMap[mod.path] = mod.content\n      }\n\n      // 在 WebWorker 中重新打包\n      const newAsarData = await modifyPackageAsync(originalData, modificationMap)\n\n      // 创建下载\n      const blob = new Blob([newAsarData.buffer as ArrayBuffer], {\n        type: 'application/octet-stream'\n      })\n      const url = URL.createObjectURL(blob)\n      const a = document.createElement('a')\n      a.href = url\n      a.download = currentAsar.value.name.replace('.asar', '-modified.asar')\n      document.body.appendChild(a)\n      a.click()\n      document.body.removeChild(a)\n      URL.revokeObjectURL(url)\n    } catch (e) {\n      error.value = e instanceof Error ? e.message : String(e)\n      throw e\n    } finally {\n      isRepacking.value = false\n    }\n  }\n\n  /**\n   * 下载原始 ASAR\n   */\n  async function downloadOriginalAsar(): Promise<void> {\n    if (!currentAsar.value) {\n      throw new Error('No ASAR loaded')\n    }\n\n    const data = await historyDB.getAsarData(currentAsar.value.id)\n    if (!data) {\n      throw new Error('ASAR data not found')\n    }\n\n    const blob = new Blob([data], { type: 'application/octet-stream' })\n    const url = URL.createObjectURL(blob)\n    const a = document.createElement('a')\n    a.href = url\n    a.download = currentAsar.value.name\n    document.body.appendChild(a)\n    a.click()\n    document.body.removeChild(a)\n    URL.revokeObjectURL(url)\n  }\n\n  // ========== 历史记录操作 ==========\n\n  /**\n   * 从历史记录中删除 ASAR\n   */\n  async function deleteFromHistory(id: string): Promise<void> {\n    // 如果是当前加载的，先关闭\n    if (currentAsar.value?.id === id) {\n      closeAsar()\n    }\n\n    await historyDB.deleteAsar(id)\n    await loadHistory()\n  }\n\n  // ========== 辅助方法 ==========\n\n  /**\n   * 获取 Workspace 实例\n   */\n  function getWorkspace(): Workspace | null {\n    return workspace\n  }\n\n  /**\n   * 获取 FileSystem 实例\n   */\n  function getFileSystem(): AsarFileSystem {\n    return asarFS\n  }\n\n  /**\n   * 刷新文件树\n   */\n  function refreshFileTree(): void {\n    fileTree.value = asarFS.getFileTree() as FileTreeNode[]\n    modifiedFiles.value = new Set(asarFS.getModifiedFiles())\n  }\n\n  // 在模块加载时初始化历史记录\n  loadHistory().catch(console.error)\n\n  return {\n    // 状态\n    currentAsar,\n    fileTree,\n    currentFile,\n    isLoadingAsar,\n    isSaving,\n    isRepacking,\n    error,\n    modifiedFiles,\n    asarHistory,\n    snapshots,\n    isEditorReady,\n    // 计算属性\n    hasModifications,\n    asarLoaded,\n    // 方法\n    setWorkspace,\n    setEditorReady,\n    loadHistory,\n    loadFromFile,\n    loadFromUrl,\n    loadFromHistory,\n    closeAsar,\n    openFile,\n    saveCurrentFile,\n    resetFile,\n    resetAllFiles,\n    createSnapshot,\n    deleteSnapshot,\n    downloadModifiedAsar,\n    downloadOriginalAsar,\n    deleteFromHistory,\n    getWorkspace,\n    getFileSystem,\n    refreshFileTree\n  }\n})\n","<script setup lang=\"ts\">\nimport { ref, onMounted } from 'vue'\nimport { Upload, Link, Loader2, History, Trash2 } from 'lucide-vue-next'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { useAsarStore } from '@/stores/asar'\n\nconst {\n  loadFromFile,\n  loadFromUrl,\n  loadFromHistory,\n  deleteFromHistory,\n  asarHistory,\n  loadHistory,\n  isLoadingAsar,\n  error\n} = useAsarStore()\n\nconst urlInput = ref('')\nconst fileInputRef = ref<HTMLInputElement | null>(null)\nconst showHistory = ref(false)\n\n// 加载历史记录\nonMounted(() => {\n  loadHistory()\n})\n\n// 处理文件选择\nfunction handleFileSelect() {\n  fileInputRef.value?.click()\n}\n\nasync function onFileChange(event: Event) {\n  const input = event.target as HTMLInputElement\n  const file = input.files?.[0]\n  if (!file) return\n\n  try {\n    await loadFromFile(file)\n  } catch (e) {\n    console.error('Failed to load file:', e)\n  } finally {\n    input.value = ''\n  }\n}\n\n// 处理 URL 加载\nasync function handleUrlLoad() {\n  if (!urlInput.value.trim()) return\n\n  try {\n    await loadFromUrl(urlInput.value.trim())\n    urlInput.value = ''\n  } catch (e) {\n    console.error('Failed to load from URL:', e)\n  }\n}\n\n// 处理文件拖放\nfunction handleDragOver(event: DragEvent) {\n  event.preventDefault()\n  event.dataTransfer!.dropEffect = 'copy'\n}\n\nasync function handleDrop(event: DragEvent) {\n  event.preventDefault()\n  const file = event.dataTransfer?.files[0]\n  if (!file || !file.name.endsWith('.asar')) return\n\n  try {\n    await loadFromFile(file)\n  } catch (e) {\n    console.error('Failed to load dropped file:', e)\n  }\n}\n\n// 从历史记录加载\nasync function handleLoadFromHistory(id: string) {\n  try {\n    await loadFromHistory(id)\n  } catch (e) {\n    console.error('Failed to load from history:', e)\n  }\n}\n\n// 从历史记录删除\nasync function handleDeleteFromHistory(id: string, event: Event) {\n  event.stopPropagation()\n  if (confirm('确定要删除这条历史记录吗？')) {\n    await deleteFromHistory(id)\n  }\n}\n\n// 格式化文件大小\nfunction formatSize(bytes: number): string {\n  if (bytes < 1024) return bytes + ' B'\n  if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB'\n  return (bytes / (1024 * 1024)).toFixed(1) + ' MB'\n}\n\n// 格式化日期\nfunction formatDate(timestamp: number): string {\n  return new Date(timestamp).toLocaleString()\n}\n</script>\n\n<template>\n  <div\n    class=\"flex flex-col items-center justify-center min-h-[400px] p-8 space-y-8 w-full max-w-2xl\"\n    @dragover=\"handleDragOver\"\n    @drop=\"handleDrop\"\n  >\n    <!-- 标题 -->\n    <div class=\"text-center space-y-2\">\n      <h1 class=\"text-3xl font-bold\">ASAR Explorer</h1>\n      <p class=\"text-muted-foreground\">在线预览和编辑 Electron ASAR 文件</p>\n    </div>\n\n    <!-- 错误提示 -->\n    <div v-if=\"error\" class=\"text-destructive text-center max-w-md\">\n      {{ error }}\n    </div>\n\n    <!-- 上传区域 -->\n    <div v-if=\"!isLoadingAsar\" class=\"w-full space-y-4\">\n      <!-- 文件上传 -->\n      <div\n        class=\"border-2 border-dashed border-muted-foreground/25 rounded-lg p-8 text-center hover:border-muted-foreground/50 transition-colors cursor-pointer\"\n        @click=\"handleFileSelect\"\n      >\n        <Upload class=\"w-12 h-12 mx-auto mb-4 text-muted-foreground\" />\n        <p class=\"text-lg font-medium\">点击或拖放 ASAR 文件</p>\n        <p class=\"text-sm text-muted-foreground mt-1\">支持 .asar 格式文件</p>\n        <input\n          ref=\"fileInputRef\"\n          type=\"file\"\n          accept=\".asar\"\n          class=\"hidden\"\n          @change=\"onFileChange\"\n        />\n      </div>\n\n      <!-- 分隔线 -->\n      <div class=\"flex items-center gap-4\">\n        <div class=\"flex-1 h-px bg-border\" />\n        <span class=\"text-sm text-muted-foreground\">或</span>\n        <div class=\"flex-1 h-px bg-border\" />\n      </div>\n\n      <!-- URL 输入 -->\n      <div class=\"flex gap-2\">\n        <Input\n          v-model=\"urlInput\"\n          placeholder=\"输入 ASAR 文件 URL...\"\n          class=\"flex-1\"\n          @keyup.enter=\"handleUrlLoad\"\n        />\n        <Button @click=\"handleUrlLoad\" :disabled=\"!urlInput.trim()\">\n          <Link class=\"w-4 h-4 mr-2\" />\n          加载\n        </Button>\n      </div>\n\n      <!-- 历史记录 -->\n      <div v-if=\"asarHistory.length > 0\" class=\"mt-6\">\n        <button\n          class=\"flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground transition-colors w-full justify-center\"\n          @click=\"showHistory = !showHistory\"\n        >\n          <History class=\"w-4 h-4\" />\n          <span>历史记录 ({{ asarHistory.length }})</span>\n        </button>\n\n        <div v-if=\"showHistory\" class=\"mt-4 space-y-2 max-h-60 overflow-y-auto\">\n          <div\n            v-for=\"item in asarHistory\"\n            :key=\"item.id\"\n            class=\"flex items-center justify-between p-3 rounded-lg border hover:bg-accent cursor-pointer transition-colors\"\n            @click=\"handleLoadFromHistory(item.id)\"\n          >\n            <div class=\"flex-1 min-w-0\">\n              <p class=\"font-medium truncate\">{{ item.name }}</p>\n              <p class=\"text-xs text-muted-foreground\">\n                {{ formatSize(item.size) }} · {{ formatDate(item.lastModifiedAt) }}\n                <span v-if=\"item.modifiedFileCount > 0\" class=\"ml-2 text-orange-500\">\n                  {{ item.modifiedFileCount }} 处修改\n                </span>\n              </p>\n            </div>\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              class=\"shrink-0 ml-2\"\n              @click=\"handleDeleteFromHistory(item.id, $event)\"\n            >\n              <Trash2 class=\"w-4 h-4 text-muted-foreground hover:text-destructive\" />\n            </Button>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- 加载中 -->\n    <div v-if=\"isLoadingAsar\" class=\"flex items-center gap-2\">\n      <Loader2 class=\"w-5 h-5 animate-spin\" />\n      <span>正在加载 ASAR 文件...</span>\n    </div>\n  </div>\n</template>\n","<script setup lang=\"ts\">\n/**\n * Monaco Editor 组件\n * 封装 modern-monaco 的初始化和渲染\n */\nimport { onMounted, onBeforeUnmount, ref } from 'vue'\nimport { Workspace, lazy } from 'modern-monaco'\nimport { useAsarStore } from '@/stores/asar'\n\nconst containerRef = ref<HTMLElement | null>(null)\nconst { getFileSystem, setWorkspace, setEditorReady, error } = useAsarStore()\n\nlet workspace: Workspace | null = null\n\nonMounted(async () => {\n  if (!containerRef.value) return\n\n  try {\n    const asarFS = getFileSystem()\n\n    // 创建 Workspace，使用自定义文件系统\n    workspace = new Workspace({\n      name: 'asar-explorer',\n      customFS: asarFS\n    })\n\n    // 初始化 lazy 模式的 Monaco\n    await lazy({\n      workspace,\n      theme: 'nord'\n    })\n\n    // 通知 store 编辑器已就绪\n    setWorkspace(workspace)\n    setEditorReady(true)\n    console.log('Monaco editor initialized')\n  } catch (e) {\n    console.error('Failed to initialize editor:', e)\n    error.value = e instanceof Error ? e.message : String(e)\n  }\n})\n\nonBeforeUnmount(() => {\n  if (workspace) {\n    // 清理 workspace\n    workspace = null\n    setWorkspace(null)\n    setEditorReady(false)\n  }\n})\n</script>\n\n<template>\n  <div ref=\"containerRef\" class=\"monaco-container\">\n    <monaco-editor class=\"w-full h-full\" />\n  </div>\n</template>\n\n<style scoped>\n.monaco-container {\n  width: 100%;\n  height: 100%;\n}\n\n.monaco-container :deep(monaco-editor) {\n  display: block;\n  width: 100%;\n  height: 100%;\n}\n</style>\n","<script setup lang=\"ts\">\nimport type { SplitterResizeHandleEmits, SplitterResizeHandleProps } from \"reka-ui\"\nimport type { HTMLAttributes } from \"vue\"\nimport { reactiveOmit } from \"@vueuse/core\"\nimport { GripVertical } from \"lucide-vue-next\"\nimport { SplitterResizeHandle, useForwardPropsEmits } from \"reka-ui\"\nimport { cn } from '@/utils/shadcn'\n\nconst props = defineProps<SplitterResizeHandleProps & { class?: HTMLAttributes[\"class\"], withHandle?: boolean }>()\nconst emits = defineEmits<SplitterResizeHandleEmits>()\n\nconst delegatedProps = reactiveOmit(props, \"class\", \"withHandle\")\nconst forwarded = useForwardPropsEmits(delegatedProps, emits)\n</script>\n\n<template>\n  <SplitterResizeHandle\n    data-slot=\"resizable-handle\"\n    v-bind=\"forwarded\"\n    :class=\"cn('bg-border focus-visible:ring-ring relative flex w-px items-center justify-center after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:ring-1 focus-visible:ring-offset-1 focus-visible:outline-hidden data-[orientation=vertical]:h-px data-[orientation=vertical]:w-full data-[orientation=vertical]:after:left-0 data-[orientation=vertical]:after:h-1 data-[orientation=vertical]:after:w-full data-[orientation=vertical]:after:-translate-y-1/2 data-[orientation=vertical]:after:translate-x-0 [&[data-orientation=vertical]>div]:rotate-90', props.class)\"\n  >\n    <template v-if=\"props.withHandle\">\n      <div class=\"bg-border z-10 flex h-4 w-3 items-center justify-center rounded-xs border\">\n        <slot>\n          <GripVertical class=\"size-2.5\" />\n        </slot>\n      </div>\n    </template>\n  </SplitterResizeHandle>\n</template>\n","<script setup lang=\"ts\">\nimport type { SplitterPanelEmits, SplitterPanelProps } from \"reka-ui\"\nimport { SplitterPanel, useForwardExpose, useForwardPropsEmits } from \"reka-ui\"\n\nconst props = defineProps<SplitterPanelProps>()\nconst emits = defineEmits<SplitterPanelEmits>()\n\nconst forwarded = useForwardPropsEmits(props, emits)\nuseForwardExpose()\n</script>\n\n<template>\n  <SplitterPanel\n    v-slot=\"slotProps\"\n    data-slot=\"resizable-panel\"\n    v-bind=\"forwarded\"\n  >\n    <slot v-bind=\"slotProps\" />\n  </SplitterPanel>\n</template>\n","<script setup lang=\"ts\">\nimport type { SplitterGroupEmits, SplitterGroupProps } from \"reka-ui\"\nimport type { HTMLAttributes } from \"vue\"\nimport { reactiveOmit } from \"@vueuse/core\"\nimport { SplitterGroup, useForwardPropsEmits } from \"reka-ui\"\nimport { cn } from '@/utils/shadcn'\n\nconst props = defineProps<SplitterGroupProps & { class?: HTMLAttributes[\"class\"] }>()\nconst emits = defineEmits<SplitterGroupEmits>()\n\nconst delegatedProps = reactiveOmit(props, \"class\")\n\nconst forwarded = useForwardPropsEmits(delegatedProps, emits)\n</script>\n\n<template>\n  <SplitterGroup\n    v-slot=\"slotProps\"\n    data-slot=\"resizable-panel-group\"\n    v-bind=\"forwarded\"\n    :class=\"cn('flex h-full w-full data-[orientation=vertical]:flex-col', props.class)\"\n  >\n    <slot v-bind=\"slotProps\" />\n  </SplitterGroup>\n</template>\n","import { createApp } from 'vue'\nimport { vaporInteropPlugin } from 'vue'\nimport './style.css'\nimport App from './App.vue'\n\ncreateApp(App).use(vaporInteropPlugin).mount('#app')\n","<script setup lang=\"ts\">\nimport { defineAsyncComponent } from 'vue'\nimport AsarUploader from '@/components/asar-uploader.vue'\nimport MonacoEditor from '@/components/monaco-editor.vue'\nimport { ResizablePanelGroup, ResizablePanel, ResizableHandle } from '@/components/ui/resizable'\nimport { useAsarStore } from '@/stores/asar'\n\nconst AsarSidebar = defineAsyncComponent(() => import('@/components/asar-sidebar.vue'))\n\nconst { asarLoaded, currentFile } = useAsarStore()\n</script>\n\n<template>\n  <!-- 未加载 ASAR -->\n  <div v-if=\"!asarLoaded\" class=\"min-h-screen flex items-center justify-center bg-background\">\n    <AsarUploader />\n  </div>\n\n  <!-- 已加载 ASAR - 使用 Resizable 布局 -->\n  <ResizablePanelGroup v-else direction=\"horizontal\" class=\"h-screen\">\n    <!-- Sidebar 面板 -->\n    <ResizablePanel :default-size=\"25\" :min-size=\"25\" :max-size=\"50\" class=\"bg-sidebar\">\n      <AsarSidebar />\n    </ResizablePanel>\n\n    <!-- 拖拽手柄 -->\n    <ResizableHandle with-handle />\n\n    <!-- 主内容面板 -->\n    <ResizablePanel :default-size=\"80\" class=\"flex flex-col h-screen\">\n      <!-- 顶部栏 -->\n      <header class=\"flex h-12 shrink-0 items-center gap-2 border-b px-4\">\n        <span class=\"text-sm text-muted-foreground\">ASAR Explorer</span>\n        <span v-if=\"currentFile\" class=\"text-sm font-medium ml-2\">{{ currentFile }}</span>\n      </header>\n\n      <!-- 主内容区 - Monaco 编辑器 -->\n      <main class=\"flex-1 min-h-0 relative\">\n        <!-- Monaco Editor 组件 -->\n        <MonacoEditor class=\"absolute inset-0\" />\n      </main>\n    </ResizablePanel>\n  </ResizablePanelGroup>\n</template>\n\n<style>\nhtml,\nbody,\n#app {\n  height: 100%;\n  margin: 0;\n  padding: 0;\n}\n\n/* Monaco Editor 样式 */\nmonaco-editor {\n  display: block;\n  width: 100%;\n  height: 100%;\n}\n</style>\n"],"file":"index-C3AQLoED.js"}